(()=>{var e={};e.id=931,e.ids=[931],e.modules={7849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},6113:e=>{"use strict";e.exports=require("crypto")},7147:e=>{"use strict";e.exports=require("fs")},3685:e=>{"use strict";e.exports=require("http")},5687:e=>{"use strict";e.exports=require("https")},5477:e=>{"use strict";e.exports=require("punycode")},2781:e=>{"use strict";e.exports=require("stream")},1576:e=>{"use strict";e.exports=require("string_decoder")},7310:e=>{"use strict";e.exports=require("url")},3837:e=>{"use strict";e.exports=require("util")},9796:e=>{"use strict";e.exports=require("zlib")},9275:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>i.a,__next_app__:()=>m,originalPathname:()=>u,pages:()=>c,routeModule:()=>h,tree:()=>d});var r=s(482),a=s(9108),n=s(2563),i=s.n(n),l=s(8300),o={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>l[e]);s.d(t,o);let d=["",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,4355)),"/home/brawl/Maker/Image-enchancer/src/app/page.tsx"]}]},{layout:[()=>Promise.resolve().then(s.bind(s,1342)),"/home/brawl/Maker/Image-enchancer/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,9361,23)),"next/dist/client/components/not-found-error"]}],c=["/home/brawl/Maker/Image-enchancer/src/app/page.tsx"],u="/page",m={require:s,loadChunk:()=>Promise.resolve()},h=new r.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/page",pathname:"/",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},2424:(e,t,s)=>{Promise.resolve().then(s.t.bind(s,2583,23)),Promise.resolve().then(s.t.bind(s,6840,23)),Promise.resolve().then(s.t.bind(s,8771,23)),Promise.resolve().then(s.t.bind(s,3225,23)),Promise.resolve().then(s.t.bind(s,9295,23)),Promise.resolve().then(s.t.bind(s,3982,23))},1270:()=>{},2365:(e,t,s)=>{Promise.resolve().then(s.bind(s,2317))},2317:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>j});var r=s(5344),a=s(3729),n=s(2751),i=s(8720),l=s(6815),o=s(9377);function d(...e){return(0,o.m6)((0,l.W)(e))}let c=(0,i.j)("inline-flex items-center justify-center rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),u=a.forwardRef(({className:e,variant:t,size:s,asChild:a=!1,...i},l)=>{let o=a?n.g7:"button";return r.jsx(o,{className:d(c({variant:t,size:s,className:e})),ref:l,...i})});u.displayName="Button";var m=s(9635);let h=a.forwardRef(({className:e,...t},s)=>(0,r.jsxs)(m.fC,{ref:s,className:d("relative flex w-full touch-none select-none items-center",e),...t,children:[r.jsx(m.fQ,{className:"relative h-1.5 w-full grow overflow-hidden rounded-full bg-primary/20",children:r.jsx(m.e6,{className:"absolute h-full bg-primary"})}),r.jsx(m.bU,{className:"block h-4 w-4 rounded-full border border-primary/50 bg-background shadow transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50"})]}));h.displayName=m.fC.displayName;var g=s(3380),p=s(5222),x=s(8168),b=s(8714),f=s(8687),y=s(1770),v=s(2283);class w{constructor(){this.UPSCALE_FACTOR=4,this.COLOR_DEPTH=255,this.loadTensorflowBackend()}async loadTensorflowBackend(){try{await v.ready(),await v.setBackend("webgl"),console.log("Using WebGL backend")}catch(e){console.warn("WebGL not available, using CPU",e),await v.setBackend("cpu")}}async superResolution(e){return v.tidy(()=>{let[t,s]=e.shape.slice(0,2),r=e;for(let e=0;e<2;e++){let a=t*Math.pow(2,e+1),n=s*Math.pow(2,e+1);r=v.image.resizeBilinear(r.expandDims(0),[a,n]).squeeze([0]);let i=this.extractHighFrequencyDetails(r);r=v.add(r,i.mul(.5)).clipByValue(0,1)}return r})}async enhanceDetails(e){return v.tidy(()=>{let t=[1,2,4,8],s=t.map(t=>{let s=this.createDetailKernel(t);return v.conv2d(e.expandDims(0),s,1,"same").squeeze([0])}),r=v.addN(s).div(t.length);return v.add(e,r.mul(.4)).clipByValue(0,1)})}async denoise(e){return v.tidy(()=>{let t=e;for(let e of[{sigma:2,kernelSize:5,strength:.8},{sigma:1,kernelSize:3,strength:.6},{sigma:.5,kernelSize:3,strength:.4}]){let s=this.createGaussianKernel(e.kernelSize,e.sigma),r=v.conv2d(t.expandDims(0),s,1,"same").squeeze([0]),a=this.detectEdges(t);t=v.add(v.mul(t,a),v.mul(r,v.sub(1,a).mul(e.strength)))}return t})}async enhanceColors(e){return v.tidy(()=>{let t=e.mul(this.COLOR_DEPTH),[s,r,a]=v.split(t,3,2),n=v.maximum(v.maximum(s,r),a),i=v.minimum(v.minimum(s,r),a);n.sub(i),s.mul(.299).add(r.mul(.587)).add(a.mul(.114));let l={vibrancy:1.3,warmth:1.1},o=n.add(i).div(2),d=s.sub(o).mul(l.vibrancy).add(o).mul(l.warmth),c=r.sub(o).mul(l.vibrancy).add(o),u=a.sub(o).mul(l.vibrancy).add(o).mul(.95);return v.stack([d,c,u],2).div(this.COLOR_DEPTH).clipByValue(0,1)})}async optimizeLighting(e){return v.tidy(()=>{let t=e.mul(this.COLOR_DEPTH),[s,r,a]=v.split(t,3,2),n=s.mul(.299).add(r.mul(.587)).add(a.mul(.114)),i=n.less(50).asType("float32"),l=n.greater(50).mul(n.less(85)).asType("float32"),o=n.greater(85).mul(n.less(128)).asType("float32"),d=n.greater(128).mul(n.less(170)).asType("float32"),c=n.greater(170).mul(n.less(220)).asType("float32"),u=n.greater(220).asType("float32"),m={deepShadows:1.4,shadows:1.3,darkMidtones:1.2,lightMidtones:1.1,highlights:.95,brightHighlights:.9};return v.addN([t.mul(i).mul(m.deepShadows),t.mul(l).mul(m.shadows),t.mul(o).mul(m.darkMidtones),t.mul(d).mul(m.lightMidtones),t.mul(c).mul(m.highlights),t.mul(u).mul(m.brightHighlights)]).div(this.COLOR_DEPTH).clipByValue(0,1)})}async enhanceSkin(e){return v.tidy(()=>{let t=e.mul(this.COLOR_DEPTH),[s,r,a]=v.split(t,3,2),n=this.detectSkinTones(s,r,a),i=this.applySkinEnhancements(s,r,a);return v.where(n,i,e)})}detectSkinTones(e,t,s){return v.tidy(()=>{let r=e.mul(.299).add(t.mul(.587)).add(s.mul(.114)),a=s.sub(r).mul(.564).add(128),n=e.sub(r).mul(.713).add(128),i=a.greater(77).mul(a.less(127)).mul(n.greater(133)).mul(n.less(173)).asType("float32");return this.smoothMask(i)})}applySkinEnhancements(e,t,s){return v.tidy(()=>{let r={warmth:1.1,brightness:1.05},a=e.mul(r.warmth).mul(r.brightness),n=t.mul(r.brightness),i=s.mul(.95).mul(r.brightness);return v.stack([a,n,i],2).div(this.COLOR_DEPTH).clipByValue(0,1)})}smoothMask(e){return v.tidy(()=>{let t=v.tensor2d([[1,2,1],[2,4,2],[1,2,1]]).div(16);return v.conv2d(e.expandDims(0),t.expandDims(2).expandDims(3),1,"same").squeeze([0])})}extractHighFrequencyDetails(e){return v.tidy(()=>{let t=v.avgPool(e.expandDims(0),[3,3],[1,1],"same").squeeze([0]);return e.sub(t).mul(2)})}createDetailKernel(e){return v.tidy(()=>{let t=3*e,s=Math.floor(t/2),r=v.buffer([t,t]);for(let a=0;a<t;a++)for(let n=0;n<t;n++){let t=a-s,i=n-s,l=0===t&&0===i?2:Math.abs(t)+Math.abs(i)<=e?-1/(4*e):0;r.set(l,a,n)}return r.toTensor().expandDims(2).tile([1,1,3]).expandDims(3)})}createGaussianKernel(e,t){return v.tidy(()=>{let s=v.buffer([e,e]),r=Math.floor(e/2);for(let a=0;a<e;a++)for(let n=0;n<e;n++){let e=a-r,i=n-r,l=Math.exp(-(e*e+i*i)/(2*t*t));s.set(l,a,n)}return s.toTensor().div(s.toTensor().sum()).expandDims(2).expandDims(3).tile([1,1,3,1])})}detectEdges(e){return v.tidy(()=>{let t=v.tensor2d([[-1,0,1],[-2,0,2],[-1,0,1]]),s=v.tensor2d([[-1,-2,-1],[0,0,0],[1,2,1]]),r=v.conv2d(e.expandDims(0),t.expandDims(2).expandDims(3).tile([1,1,3,1]),1,"same"),a=v.conv2d(e.expandDims(0),s.expandDims(2).expandDims(3).tile([1,1,3,1]),1,"same");return v.sqrt(r.square().add(a.square())).squeeze([0]).greater(.2).asType("float32")})}async enhance(e){try{let t=v.tidy(()=>v.browser.fromPixels(e).toFloat().div(this.COLOR_DEPTH)),s=await this.denoise(t),r=await this.superResolution(s),a=await this.enhanceDetails(r),n=await this.enhanceColors(a),i=await this.optimizeLighting(n),l=await this.enhanceSkin(i),o=v.tidy(()=>{let e={sharpness:1.3,contrast:1.25,brightness:1.1,clarity:1.2};return l.mul(e.contrast).mul(e.brightness).mul(e.sharpness).mul(e.clarity).clipByValue(0,1)}),d=document.createElement("canvas"),c=d.getContext("2d"),[u,m]=o.shape.slice(0,2);d.width=m,d.height=u,await v.browser.toPixels(o,d);let h=c.getImageData(0,0,d.width,d.height);return v.dispose([t,s,r,a,n,i,l,o]),h}catch(t){return console.error("Error enhancing image:",t),e}}}function j(){let[e,t]=(0,a.useState)(null),[s,n]=(0,a.useState)(null),[i,l]=(0,a.useState)(100),[o,d]=(0,a.useState)(100),[c,m]=(0,a.useState)(!1),[v,j]=(0,a.useState)(50),N=(0,a.useRef)(),D=(0,a.useRef)(null);(0,a.useEffect)(()=>{(async()=>{N.current=new w})()},[]);let k=async()=>{if(e&&N.current){m(!0);try{let t=document.createElement("canvas"),s=t.getContext("2d");if(!s)throw Error("Could not get canvas context");let r=new Image;r.crossOrigin="anonymous",await new Promise((t,s)=>{r.onload=t,r.onerror=s,r.src=e}),t.width=r.width,t.height=r.height,s.drawImage(r,0,0);let a=s.getImageData(0,0,t.width,t.height),i=await N.current.enhance(a);s.putImageData(i,0,0);let l=t.toDataURL("image/png");n(l)}catch(e){console.error("Error during AI enhancement:",e)}finally{m(!1)}}};return r.jsx("div",{className:"min-h-screen bg-gray-900 text-gray-100 p-4",children:(0,r.jsxs)("div",{className:"container mx-auto max-w-3xl",children:[r.jsx("h1",{className:"text-2xl font-bold mb-6 text-center",children:"Image Enhancer"}),r.jsx("div",{className:"mb-6",children:(0,r.jsxs)("div",{className:"border border-gray-700 rounded-lg p-8 text-center cursor-pointer hover:bg-gray-800 transition-colors",onDragOver:e=>{e.preventDefault()},onDrop:e=>{e.preventDefault();let s=e.dataTransfer.files[0];if(s){let e=new FileReader;e.onload=e=>{let s=e.target?.result;"string"==typeof s&&t(s)},e.readAsDataURL(s)}},children:[r.jsx("input",{type:"file",accept:"image/*",onChange:e=>{let s=e.target.files?.[0];if(s){let e=new FileReader;e.onload=e=>{let s=e.target?.result;"string"==typeof s&&t(s)},e.readAsDataURL(s)}},className:"hidden",id:"imageUpload"}),(0,r.jsxs)("label",{htmlFor:"imageUpload",className:"cursor-pointer",children:[r.jsx(g.Z,{className:"mx-auto h-8 w-8 text-gray-400"}),r.jsx("p",{className:"mt-2 text-sm text-gray-400",children:"Upload image"})]})]})}),e&&s&&(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{ref:D,className:"relative h-[500px] overflow-hidden rounded-lg cursor-col-resize",onMouseMove:e=>{if(!D.current)return;let t=D.current.getBoundingClientRect();j(Math.min(Math.max((e.clientX-t.left)/t.width*100,0),100))},children:[r.jsx("img",{src:e,alt:"Original",className:"absolute top-0 left-0 w-full h-full object-contain"}),r.jsx("img",{src:s,alt:"Enhanced",className:"absolute top-0 left-0 w-full h-full object-contain",style:{clipPath:`inset(0 ${100-v}% 0 0)`}}),r.jsx("div",{className:"absolute top-0 bottom-0 w-1 bg-white cursor-col-resize",style:{left:`${v}%`},children:(0,r.jsxs)("div",{className:"absolute top-1/2 -translate-y-1/2 left-1/2 -translate-x-1/2 w-8 h-8 bg-white rounded-full flex items-center justify-center shadow-lg",children:[r.jsx("div",{className:"w-6 h-px bg-gray-800 rotate-90"}),r.jsx("div",{className:"w-6 h-px bg-gray-800 absolute"})]})}),r.jsx("div",{className:"absolute top-4 left-4 bg-black/50 px-2 py-1 rounded",children:"Original"}),r.jsx("div",{className:"absolute top-4 right-4 bg-black/50 px-2 py-1 rounded",children:"Enhanced"})]}),(0,r.jsxs)("div",{className:"mt-6 space-y-4",children:[(0,r.jsxs)("div",{children:[r.jsx("label",{htmlFor:"brightness",className:"block text-sm font-medium mb-1",children:"Brightness"}),(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[r.jsx(p.Z,{className:"h-4 w-4 text-gray-400"}),r.jsx(h,{id:"brightness",min:0,max:200,step:1,value:[i],onValueChange:e=>l(e[0]),className:"flex-grow"}),r.jsx(x.Z,{className:"h-4 w-4 text-gray-400"})]})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{htmlFor:"contrast",className:"block text-sm font-medium mb-1",children:"Contrast"}),(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[r.jsx(b.Z,{className:"h-4 w-4 text-gray-400"}),r.jsx(h,{id:"contrast",min:0,max:200,step:1,value:[o],onValueChange:e=>d(e[0]),className:"flex-grow"}),r.jsx(f.Z,{className:"h-4 w-4 text-gray-400"})]})]})]})]}),(0,r.jsxs)("div",{className:"mt-6 flex justify-center space-x-4",children:[s&&r.jsx(u,{onClick:()=>{if(!s)return;let e=document.createElement("a");e.href=s,e.download="enhanced-image.png",document.body.appendChild(e),e.click(),document.body.removeChild(e)},variant:"outline",className:"bg-gray-800 text-gray-100 hover:bg-gray-700",children:"Download Enhanced Image"}),(0,r.jsxs)(u,{onClick:k,className:"bg-blue-600 text-white hover:bg-blue-700",disabled:c||!e,children:[r.jsx(y.Z,{className:"w-4 h-4 mr-2"}),c?"Enhancing...":"AI Enhance"]})]})]})})}},1342:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>n,metadata:()=>a});var r=s(5036);s(5023);let a={title:"AI Image Enhancer",description:"Enhance your images using AI"};function n({children:e}){return(0,r.jsxs)("html",{lang:"en",children:[r.jsx("head",{children:r.jsx("meta",{name:"viewport",content:"width=device-width, initial-scale=1"})}),r.jsx("body",{children:e})]})}},4355:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o});var r=s(5036);let a=(0,s(6843).createProxy)(String.raw`/home/brawl/Maker/Image-enchancer/src/components/ImageEnhancer.tsx`),{__esModule:n,$$typeof:i}=a,l=a.default;function o(){return r.jsx(l,{})}},5023:()=>{}};var t=require("../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[440,225,359,407,664,71,841,227],()=>s(9275));module.exports=r})();